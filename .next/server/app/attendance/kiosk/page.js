(()=>{var e={};e.id=205,e.ids=[205],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},7929:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>h,tree:()=>d});var i=r(482),t=r(9108),a=r(2563),n=r.n(a),c=r(8300),l={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>c[e]);r.d(s,l);let d=["",{children:["attendance",{children:["kiosk",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,7959)),"/Users/isaackumi/devel/gigs/cop-chMS/app/attendance/kiosk/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,2323)),"/Users/isaackumi/devel/gigs/cop-chMS/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9361,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/isaackumi/devel/gigs/cop-chMS/app/attendance/kiosk/page.tsx"],m="/attendance/kiosk/page",x={require:r,loadChunk:()=>Promise.resolve()},h=new i.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/attendance/kiosk/page",pathname:"/attendance/kiosk",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},6837:(e,s,r)=>{Promise.resolve().then(r.bind(r,1152))},1152:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>k});var i=r(5344),t=r(3729),a=r(2254),n=r(1815),c=r(1351),l=r(6212),d=r(2549),o=r(6448),m=r(3101),x=r(8765),h=r(8822),u=r(7060),p=r(6234),j=r(1626),f=r(692);function y({onCheckInSuccess:e,className:s}){let[r,a]=(0,t.useState)(""),[n,y]=(0,t.useState)([]),[g,v]=(0,t.useState)(null),[b,N]=(0,t.useState)([]),[k,w]=(0,t.useState)([]),[S,_]=(0,t.useState)("sunday_service"),[C,P]=(0,t.useState)(!1),[q,Z]=(0,t.useState)(!1),M=(0,p.e)(),{toast:I}=(0,f.pm)(),D=async()=>{if(r.trim()){Z(!0);try{let e=r.trim(),{data:s,error:i}=await M.from("app_users").select(`
          *,
          members (*)
        `).or(`membership_id.ilike.%${e}%,phone.ilike.%${e}%,full_name.ilike.%${e}%`).limit(10);if(i){console.error("Search error:",i),I({title:"Search Error",description:"Failed to search for members. Please try again.",variant:"destructive"});return}y(s||[])}catch(e){console.error("Search error:",e),I({title:"Search Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{Z(!1)}}},z=async e=>{if(v(e),y([]),a(""),e.member){let{data:s,error:r}=await M.from("dependants").select("*").eq("member_id",e.member.id);!r&&s&&N(s)}},E=e=>{w(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},O=async()=>{if(g&&g.member){P(!0);try{let s=crypto.randomUUID(),r=new Date().toISOString().split("T")[0],{error:i}=await M.from("attendance").insert({member_id:g.member.id,service_date:r,service_type:S,method:"kiosk",client_uuid:s,metadata:{kiosk_checkin:!0,timestamp:new Date().toISOString()}});if(i){console.error("Check-in error:",i),I({title:"Check-in Error",description:"Failed to check in member. Please try again.",variant:"destructive"});return}let t=k.map(e=>({dependant_id:e,service_date:r,service_type:S,method:"kiosk",client_uuid:crypto.randomUUID(),metadata:{kiosk_checkin:!0,parent_member_id:g.member?.id,timestamp:new Date().toISOString()}}));if(t.length>0){let{error:e}=await M.from("attendance").insert(t);e&&(console.error("Dependants check-in error:",e),I({title:"Partial Check-in",description:"Member checked in, but some family members failed to check in.",variant:"destructive"}))}I({title:"Check-in Successful",description:`${g.full_name} has been checked in successfully.`}),e(g.member,b.filter(e=>k.includes(e.id))),v(null),N([]),w([]),a("")}catch(e){console.error("Check-in error:",e),I({title:"Check-in Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{P(!1)}}},U=()=>{v(null),N([]),w([]),a(""),y([])};return(0,i.jsxs)(c.Zb,{className:s,children:[(0,i.jsxs)(c.Ol,{children:[(0,i.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[i.jsx(m.Z,{className:"h-5 w-5"}),i.jsx("span",{children:"Kiosk Check-in"})]}),i.jsx(c.SZ,{children:"Search for a member and check them in for today's service."})]}),i.jsx(c.aY,{children:(0,i.jsxs)("div",{className:"space-y-6",children:[g?(0,i.jsxs)("div",{className:"space-y-4",children:[i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"h-12 w-12 bg-blue-100 rounded-full flex items-center justify-center",children:i.jsx(h.Z,{className:"h-6 w-6 text-blue-600"})}),(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"font-medium text-lg",children:g.full_name}),(0,i.jsxs)("div",{className:"text-sm text-gray-600 space-x-2",children:[g.membership_id&&i.jsx("span",{children:(0,j.tC)(g.membership_id)}),g.phone&&i.jsx("span",{children:(0,j.un)(g.phone)})]})]})]}),i.jsx(l.z,{variant:"outline",size:"sm",onClick:U,children:"Change"})]})}),(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx(o._,{htmlFor:"service-type",children:"Service Type"}),(0,i.jsxs)("select",{id:"service-type",value:S,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 border border-input bg-background rounded-md text-sm",children:[i.jsx("option",{value:"sunday_service",children:"Sunday Service"}),i.jsx("option",{value:"midweek_service",children:"Midweek Service"}),i.jsx("option",{value:"prayer_meeting",children:"Prayer Meeting"}),i.jsx("option",{value:"youth_service",children:"Youth Service"}),i.jsx("option",{value:"children_service",children:"Children Service"}),i.jsx("option",{value:"special_event",children:"Special Event"})]})]}),b.length>0&&(0,i.jsxs)("div",{className:"space-y-3",children:[i.jsx(o._,{children:"Family Members (Optional)"}),i.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:b.map(e=>(0,i.jsxs)("div",{className:`flex items-center space-x-3 p-3 border rounded-lg cursor-pointer ${k.includes(e.id)?"bg-green-50 border-green-200":"hover:bg-gray-50"}`,onClick:()=>E(e.id),children:[i.jsx("div",{className:`h-6 w-6 rounded-full border-2 flex items-center justify-center ${k.includes(e.id)?"bg-green-500 border-green-500":"border-gray-300"}`,children:k.includes(e.id)&&i.jsx(u.Z,{className:"h-4 w-4 text-white"})}),(0,i.jsxs)("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium",children:e.first_name}),i.jsx("p",{className:"text-sm text-gray-500 capitalize",children:e.relationship})]})]},e.id))})]}),(0,i.jsxs)("div",{className:"flex space-x-2 pt-4",children:[i.jsx(l.z,{onClick:U,variant:"outline",className:"flex-1",children:"Cancel"}),i.jsx(l.z,{onClick:O,disabled:C,className:"flex-1",children:C?"Checking In...":(0,i.jsxs)(i.Fragment,{children:[i.jsx(u.Z,{className:"h-4 w-4 mr-2"}),"Check In"]})})]})]}):(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx(o._,{htmlFor:"search",children:"Search Member"}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsxs)("div",{className:"relative flex-1",children:[i.jsx(x.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(d.I,{id:"search",placeholder:"Enter membership ID, phone, or name...",value:r,onChange:e=>a(e.target.value),onKeyPress:e=>"Enter"===e.key&&D(),className:"pl-10"})]}),i.jsx(l.z,{onClick:D,disabled:q||!r.trim(),children:q?"Searching...":"Search"})]})]}),n.length>0&&(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("h4",{className:"font-medium text-sm text-gray-700",children:"Search Results:"}),i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:n.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>z(e),children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center",children:i.jsx(h.Z,{className:"h-5 w-5 text-blue-600"})}),(0,i.jsxs)("div",{children:[i.jsx("p",{className:"font-medium",children:e.full_name}),(0,i.jsxs)("div",{className:"text-sm text-gray-500 space-x-2",children:[e.membership_id&&i.jsx("span",{children:(0,j.tC)(e.membership_id)}),e.phone&&i.jsx("span",{children:(0,j.un)(e.phone)})]})]})]}),i.jsx(l.z,{variant:"outline",size:"sm",children:"Select"})]},e.id))})]})]}),(0,i.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Instructions:"}),(0,i.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[i.jsx("li",{children:"• Search for a member by ID, phone, or name"}),i.jsx("li",{children:"• Select the member from search results"}),i.jsx("li",{children:"• Choose service type and optional family members"}),i.jsx("li",{children:'• Click "Check In" to complete the process'})]})]})]})})]})}var g=r(3024),v=r(3686),b=r(5794),N=r(9895);function k(){let[e,s]=(0,t.useState)([]),r=(0,a.useRouter)(),{toast:d}=(0,f.pm)();return(0,i.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[i.jsx(n.w,{}),(0,i.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsxs)(l.z,{variant:"outline",onClick:()=>r.back(),children:[i.jsx(g.Z,{className:"h-4 w-4 mr-2"}),"Back"]}),i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Kiosk Check-in"})]}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsxs)(l.z,{variant:"outline",onClick:()=>r.push("/attendance/scanner"),children:[i.jsx(v.Z,{className:"h-4 w-4 mr-2"}),"QR Scanner"]}),(0,i.jsxs)(l.z,{variant:"outline",onClick:()=>r.push("/attendance"),children:[i.jsx(b.Z,{className:"h-4 w-4 mr-2"}),"View Attendance"]})]})]}),i.jsx("p",{className:"text-gray-600",children:"Search for members and check them in for today's service."})]}),(0,i.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[i.jsx("div",{className:"lg:col-span-2",children:i.jsx(y,{onCheckInSuccess:(e,r)=>{s(s=>[{member:e,dependants:r,timestamp:new Date().toISOString()},...s.slice(0,4)])}})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(c.Zb,{children:[(0,i.jsxs)(c.Ol,{children:[(0,i.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[i.jsx(u.Z,{className:"h-5 w-5 text-green-600"}),i.jsx("span",{children:"Recent Check-ins"})]}),i.jsx(c.SZ,{children:"Today's successful check-ins"})]}),i.jsx(c.aY,{children:0===e.length?(0,i.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(N.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:"No check-ins yet today"}),i.jsx("p",{className:"text-sm",children:"Check-ins will appear here"})]}):i.jsx("div",{className:"space-y-3",children:e.map((e,s)=>(0,i.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[i.jsx("div",{className:"h-8 w-8 bg-green-100 rounded-full flex items-center justify-center",children:i.jsx(u.Z,{className:"h-4 w-4 text-green-600"})}),(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-medium text-sm truncate",children:e.member.user?.full_name||"Unknown Member"}),i.jsx("p",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleTimeString()}),e.dependants&&e.dependants.length>0&&(0,i.jsxs)("p",{className:"text-xs text-gray-500",children:["+",e.dependants.length," family member(s)"]})]})]},s))})})]}),(0,i.jsxs)(c.Zb,{className:"mt-6",children:[i.jsx(c.Ol,{children:i.jsx(c.ll,{className:"text-lg",children:"Today's Stats"})}),i.jsx(c.aY,{children:(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Total Check-ins:"}),i.jsx("span",{className:"font-medium",children:e.length})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Family Members:"}),i.jsx("span",{className:"font-medium",children:e.reduce((e,s)=>e+(s.dependants?.length||0),0)})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Service:"}),i.jsx("span",{className:"font-medium",children:"Sunday Service"})]})]})})]})]})]}),i.jsx("div",{className:"mt-8",children:(0,i.jsxs)(c.Zb,{children:[i.jsx(c.Ol,{children:(0,i.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[i.jsx(m.Z,{className:"h-5 w-5"}),i.jsx("span",{children:"Kiosk Mode Instructions"})]})}),i.jsx(c.aY,{children:(0,i.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,i.jsxs)("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"For Members:"}),(0,i.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[i.jsx("li",{children:"• Approach the kiosk and wait for assistance"}),i.jsx("li",{children:"• Provide your membership ID, phone number, or name"}),i.jsx("li",{children:"• Select any family members to check in together"}),i.jsx("li",{children:"• Confirm your details and complete check-in"})]})]}),(0,i.jsxs)("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"For Administrators:"}),(0,i.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[i.jsx("li",{children:"• Use the search function to find members quickly"}),i.jsx("li",{children:"• Verify member identity before check-in"}),i.jsx("li",{children:"• Include family members when requested"}),i.jsx("li",{children:"• Monitor recent check-ins for accuracy"})]})]})]})})]})})]})]})}},2549:(e,s,r)=>{"use strict";r.d(s,{I:()=>n});var i=r(5344),t=r(3729),a=r(1626);let n=t.forwardRef(({className:e,type:s,...r},t)=>i.jsx("input",{type:s,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...r}));n.displayName="Input"},6448:(e,s,r)=>{"use strict";r.d(s,{_:()=>d});var i=r(5344),t=r(3729),a=r(4217),n=r(9247),c=r(1626);let l=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=t.forwardRef(({className:e,...s},r)=>i.jsx(a.f,{ref:r,className:(0,c.cn)(l(),e),...s}));d.displayName=a.f.displayName},3101:(e,s,r)=>{"use strict";r.d(s,{Z:()=>i});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,r(9224).Z)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]])},8765:(e,s,r)=>{"use strict";r.d(s,{Z:()=>i});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,r(9224).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},7959:(e,s,r)=>{"use strict";r.r(s),r.d(s,{$$typeof:()=>a,__esModule:()=>t,default:()=>n});let i=(0,r(6843).createProxy)(String.raw`/Users/isaackumi/devel/gigs/cop-chMS/app/attendance/kiosk/page.tsx`),{__esModule:t,$$typeof:a}=i,n=i.default},4217:(e,s,r)=>{"use strict";r.d(s,{f:()=>c});var i=r(3729),t=r(2409),a=r(5344),n=i.forwardRef((e,s)=>(0,a.jsx)(t.WV.label,{...e,ref:s,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(e.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));n.displayName="Label";var c=n}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),i=s.X(0,[638,861,499,721,945,80],()=>r(7929));module.exports=i})();